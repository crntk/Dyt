@using Dyt.Contracts.Appointments.Responses
@using Dyt.Data.Entities.Content
@{
    ViewData["Title"] = "Bildirimler";
    var pendingAppointments = (List<AppointmentDto>)ViewBag.PendingAppointments;
    var unreadMessages = (List<ContactMessage>)ViewBag.UnreadMessages;
    var totalCount = (int)ViewBag.TotalNotifications;
 var now = DateTime.Now;
    var today = DateOnly.FromDateTime(now);
 var nowTime = TimeOnly.FromDateTime(now);
    var tr = new System.Globalization.CultureInfo("tr-TR");
}

<style>
  :root{ --brand:#4CAF50; --brand-orange:#FF9800 }
  
  /* Hero with green gradient */
  .notif-hero{
    position:relative;
    overflow:hidden;
    background:
   radial-gradient(1200px 500px at 20% -10%, rgba(76,175,80,.18), transparent),
   radial-gradient(900px 350px at 80% -10%, rgba(255,152,0,.15), transparent);
    padding:48px 0 36px;
 }
  .notif-hero:before{
    content:"";
 position:absolute;
  inset:-20%;
  background:
      radial-gradient(rgba(76,175,80,.15) 1px, transparent 1.5px),
      radial-gradient(rgba(255,152,0,.08) 1px, transparent 1.5px);
    background-size:32px 32px, 64px 64px;
 background-position:0 0, 16px 16px;
    opacity:.4;
    animation:dotMove 25s linear infinite;
  }
  @@keyframes dotMove{from{transform:translate(0,0)}to{transform:translate(32px,32px)}}

  /* Stats card */
  .stats-overview{
    display:grid;
    grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));
 gap:20px;
margin-bottom:32px;
  }
  
  .stat-box{
 background:linear-gradient(135deg, rgba(76,175,80,.08), rgba(255,152,0,.05));
    border:2px solid rgba(76,175,80,.2);
 border-radius:16px;
    padding:24px;
text-align:center;
    transition:all .3s ease;
  }
  
  .stat-box:hover{
 transform:translateY(-4px);
    box-shadow:0 8px 24px rgba(76,175,80,.2);
  }
  
  .stat-icon{
    font-size:48px;
    margin-bottom:12px;
  }

  .stat-icon svg{
    width:48px;
    height:48px;
    fill:currentColor;
  }
  
  .stat-number{
    font-size:40px;
  font-weight:800;
    background:linear-gradient(135deg, #4CAF50, #81C784);
    -webkit-background-clip:text;
    -webkit-text-fill-color:transparent;
    background-clip:text;
    line-height:1;
    margin-bottom:8px;
  }
  
  .stat-label{
    font-size:14px;
  font-weight:600;
    color:#64748b;
    text-transform:uppercase;
letter-spacing:0.5px;
  }

  /* Notification cards */
.notification-card{
    background:#fff;
    border:2px solid rgba(76,175,80,.2);
    border-radius:16px;
    padding:20px;
    margin-bottom:16px;
    transition:all .3s ease;
  }
  
  .notification-card:hover{
    transform:translateY(-4px);
    box-shadow:0 12px 30px rgba(76,175,80,.2);
    border-color:#4CAF50;
  }
  
.notification-card.appointment{
    border-left:6px solid #4CAF50;
  }
  
  .notification-card.message{
    border-left:6px solid #FF9800;
  }
  
  .notification-header{
  display:flex;
    justify-content:space-between;
    align-items:flex-start;
    margin-bottom:12px;
    padding-bottom:12px;
    border-bottom:2px solid rgba(76,175,80,.15);
  }
  
  .notification-icon{
 width:48px;
    height:48px;
    border-radius:12px;
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:24px;
    margin-right:16px;
    flex-shrink:0;
  }

  .notification-icon svg{
    width:28px;
    height:28px;
    fill:currentColor;
  }
  
  .notification-icon.appointment{
    background:linear-gradient(135deg, rgba(76,175,80,.15), rgba(129,199,132,.1));
    color:#4CAF50;
  }
  
  .notification-icon.message{
 background:linear-gradient(135deg, rgba(255,152,0,.15), rgba(255,183,77,.1));
 color:#FF9800;
  }
  
  .notification-content{
  flex:1;
  }
  
  .notification-title{
    font-size:18px;
 font-weight:700;
    color:#1e293b;
 margin-bottom:6px;
  }
  
  .notification-details{
    font-size:14px;
    color:#64748b;
    margin-bottom:12px;
  }

  .notification-details svg{
    width:14px;
    height:14px;
    vertical-align:middle;
    margin-right:4px;
    fill:currentColor;
  }
  
  .notification-time{
    font-size:12px;
    font-weight:600;
    color:#94a3b8;
text-transform:uppercase;
    letter-spacing:0.5px;
  }

  .notification-time svg{
    width:12px;
    height:12px;
    vertical-align:middle;
margin-right:4px;
    fill:currentColor;
  }
  
  .notification-actions{
    display:flex;
    gap:10px;
flex-wrap:wrap;
    margin-top:12px;
  }
  
  .btn-notif{
    padding:8px 16px;
    border-radius:10px;
    font-weight:600;
    font-size:13px;
    border:2px solid transparent;
    transition:all .3s ease;
    display:inline-flex;
    align-items:center;
    gap:6px;
    text-decoration:none;
  }

  .btn-notif svg{
    width:16px;
    height:16px;
    fill:currentColor;
  }
  
  .btn-notif.primary{
    background:linear-gradient(135deg, #4CAF50, #81C784);
    color:#fff;
  }
  
  .btn-notif.primary:hover{
    background:linear-gradient(135deg, #388E3C, #4CAF50);
    transform:translateY(-2px);
    box-shadow:0 6px 16px rgba(76,175,80,.3);
    color:#fff;
  }
  
  .btn-notif.secondary{
    background:#fff;
    color:#4CAF50;
    border-color:rgba(76,175,80,.3);
  }
  
  .btn-notif.secondary:hover{
    background:rgba(76,175,80,.1);
    border-color:#4CAF50;
    transform:translateY(-2px);
  }

  /* Badge */
  .badge-new{
    background:linear-gradient(135deg, #FF9800, #FFB74D);
    color:#fff;
    padding:4px 10px;
 border-radius:999px;
    font-weight:700;
    font-size:11px;
text-transform:uppercase;
  letter-spacing:0.5px;
    box-shadow:0 2px 8px rgba(255,152,0,.3);
  }

  /* Empty state */
  .empty-state{
    text-align:center;
    padding:80px 20px;
  }
  
  .empty-state-icon{
    font-size:80px;
 margin-bottom:20px;
    opacity:.5;
  }

  .empty-state-icon svg{
    width:80px;
    height:80px;
    fill:#4CAF50;
  }
  
  .empty-state-title{
    font-size:24px;
    font-weight:700;
    color:#333;
  margin-bottom:12px;
  }
  
  .empty-state-text{
    font-size:16px;
    color:#666;
  }

  /* Reveal animation */
  [data-reveal]{opacity:0;transform:translateY(30px);transition:opacity .6s ease, transform .6s ease}
  [data-reveal].in{opacity:1;transform:translateY(0)}
</style>

<!-- Hero -->
<section class="notif-hero">
  <div class="container position-relative" style="z-index:1">
    <div class="text-center" data-reveal>
      <h1 class="display-5 fw-bold mb-3">
        <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" class="bi bi-bell-fill d-inline-block" viewBox="0 0 16 16" style="vertical-align:middle;margin-right:12px;">
      <path d="M8 16a2 2 0 0 0 2-2H6a2 2 0 0 0 2 2m.995-14.901a1 1 0 1 0-1.99 0A5 5 0 0 0 3 6c0 1.098-.5 6-2 7h14c-1.5-1-2-5.902-2-7 0-2.42-1.72-4.44-4.005-4.901"/>
        </svg>
  Bildirimler
      </h1>
    <p class="lead mb-0">Yeni randevu talepleri ve iletiþim mesajlarýnýz</p>
    </div>
  </div>
</section>

<div class="container py-5">
  <!-- Stats Overview -->
  <div class="stats-overview" data-reveal>
    <div class="stat-box">
      <div class="stat-icon" style="color:#4CAF50;">
      <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-calendar-check" viewBox="0 0 16 16">
          <path d="M10.854 7.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 9.793l2.646-2.647a.5.5 0 0 1 .708 0"/>
          <path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5M1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4z"/>
  </svg>
      </div>
      <div class="stat-number">@pendingAppointments.Count</div>
      <div class="stat-label">Bekleyen Randevu</div>
    </div>
    
    <div class="stat-box">
      <div class="stat-icon" style="color:#FF9800;">
        <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-envelope-open" viewBox="0 0 16 16">
          <path d="M8.47 1.318a1 1 0 0 0-.94 0l-6 3.2A1 1 0 0 0 1 5.4v.817l5.75 3.45L8 8.917l1.25.75L15 6.217V5.4a1 1 0 0 0-.53-.882zM15 7.383l-4.778 2.867L15 13.117zm-.035 6.88L8 10.082l-6.965 4.18A1 1 0 0 0 2 15h12a1 1 0 0 0 .965-.738ZM1 13.116l4.778-2.867L1 7.383v5.734ZM7.059.435a2 2 0 0 1 1.882 0l6 3.2A2 2 0 0 1 16 5.4V14a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V5.4a2 2 0 0 1 1.059-1.765z"/>
  </svg>
      </div>
      <div class="stat-number">@unreadMessages.Count</div>
 <div class="stat-label">Okunmamýþ Mesaj</div>
 </div>
    
    <div class="stat-box">
      <div class="stat-icon" style="color:#2196F3;">
        <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-bell-fill" viewBox="0 0 16 16">
    <path d="M8 16a2 2 0 0 0 2-2H6a2 2 0 0 0 2 2m.995-14.901a1 1 0 1 0-1.99 0A5 5 0 0 0 3 6c0 1.098-.5 6-2 7h14c-1.5-1-2-5.902-2-7 0-2.42-1.72-4.44-4.005-4.901"/>
        </svg>
      </div>
      <div class="stat-number">@totalCount</div>
  <div class="stat-label">Toplam Bildirim</div>
    </div>
  </div>

  @if (totalCount == 0)
  {
    <div class="card" data-reveal>
    <div class="card-body">
        <div class="empty-state">
    <div class="empty-state-icon">
       <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-check-circle-fill" viewBox="0 0 16 16">
   <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0m-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"/>
   </svg>
          </div>
          <h3 class="empty-state-title">Tüm Bildirimler Temiz!</h3>
  <p class="empty-state-text">Yeni randevu talebi veya iletiþim mesajý bulunmamaktadýr.</p>
   </div>
  </div>
  </div>
  }
  else
  {
    <!-- Bekleyen Randevular -->
    @if (pendingAppointments.Any())
  {
      <div data-reveal>
        <h4 class="mb-4 fw-bold">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-calendar-check d-inline-block" viewBox="0 0 16 16" style="vertical-align:middle;margin-right:8px;">
       <path d="M10.854 7.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 9.793l2.646-2.647a.5.5 0 0 1 .708 0"/>
    <path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5M1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4z"/>
  </svg>
 Bekleyen Randevu Talepleri (@pendingAppointments.Count)
     </h4>
        
        @foreach (var a in pendingAppointments)
    {
   var isPast = a.Date < today || (a.Date == today && a.EndTime <= nowTime);
    
          <div class="notification-card appointment">
            <div class="notification-header">
        <div class="d-flex align-items-start flex-grow-1">
  <div class="notification-icon appointment">
             <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-calendar-event" viewBox="0 0 16 16">
    <path d="M11 6.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5z"/>
          <path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5M1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4z"/>
            </svg>
       </div>
        <div class="notification-content">
       <div class="notification-title">
    @a.ClientName 
         <span class="badge-new">YENÝ</span>
         </div>
       <div class="notification-details">
          <strong>
             <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-calendar3" viewBox="0 0 16 16">
 <path d="M14 0H2a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2M1 3.857C1 3.384 1.448 3 2 3h12c.552 0 1 .384 1 .857v10.286c0 .473-.448.857-1 .857H2c-.552 0-1-.384-1-.857z"/>
         <path d="M6.5 7a1 1 0 1 0 0-2 1 1 0 0 0 0 2m3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2m3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2m-9 3a1 1 0 1 0 0-2 1 1 0 0 0 0 2m3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2m3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2m3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2m-9 3a1 1 0 1 0 0-2 1 1 0 0 0 0 2m3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2m3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2"/>
      </svg>
   @a.Date.ToString("dd MMMM yyyy (dddd)", tr)
          </strong><br/>
 <strong>
           <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-clock" viewBox="0 0 16 16">
 <path d="M8 3.5a.5.5 0 0 0-1 0V9a.5.5 0 0 0 .252.434l3.5 2a.5.5 0 0 0 .496-.868L8 8.71z"/>
           <path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16m7-8A7 7 0 1 1 1 8a7 7 0 0 1 14 0"/>
</svg>
 @a.StartTime.ToString("HH\\:mm") - @a.EndTime.ToString("HH\\:mm")
        </strong><br/>
           <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-chat-dots" viewBox="0 0 16 16">
 <path d="M5 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0m4 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0m3 1a1 1 0 1 0 0-2 1 1 0 0 0 0 2"/>
         <path d="m2.165 15.803.02-.004c1.83-.363 2.948-.842 3.468-1.105A9 9 0 0 0 8 15c4.418 0 8-3.134 8-7s-3.582-7-8-7-8 3.134-8 7c0 1.76.743 3.37 1.97 4.6a10.4 10.4 0 0 1-.524 2.318l-.003.011a11 11 0 0 1-.244.637c-.079.186.074.394.273.362a22 22 0 0 0 .693-.125m.8-3.108a1 1 0 0 0-.287-.801C1.618 10.83 1 9.468 1 8c0-3.192 3.004-6 7-6s7 2.808 7 6-3.004 6-7 6a8 8 0 0 1-2.088-.272 1 1 0 0 0-.711.074c-.387.196-1.24.57-2.634.893a11 11 0 0 0 .398-2"/>
    </svg>
                    @(a.Channel == "Online" ? "Online Görüþme" : "Yüzyüze Görüþme")<br/>
         <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-phone" viewBox="0 0 16 16">
           <path d="M11 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zM5 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z"/>
           <path d="M8 14a1 1 0 1 0 0-2 1 1 0 0 0 0 2"/>
      </svg>
          @a.ClientPhone
         @if (!string.IsNullOrEmpty(a.ClientEmail))
     {
     <br/>
    <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-envelope" viewBox="0 0 16 16">
      <path d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2zm2-1a1 1 0 0 0-1 1v.217l7 4.2 7-4.2V4a1 1 0 0 0-1-1zm13 2.383-4.708 2.825L15 11.105zm-.034 6.876-5.64-3.471L8 9.583l-1.326-.795-5.64 3.47A1 1 0 0 0 2 13h12a1 1 0 0 0 .966-.741M1 11.105l4.708-2.897L1 5.383z"/>
              </svg>
          @a.ClientEmail
     }
       </div>
          <div class="notification-time">
             @{
   var createdTime = a.CreatedAtUtc.ToLocalTime();
   var timeDiff = now - createdTime;
    var timeAgo = timeDiff.TotalMinutes < 60 
? $"{(int)timeDiff.TotalMinutes} dakika önce"
              : timeDiff.TotalHours < 24 
    ? $"{(int)timeDiff.TotalHours} saat önce"
                 : $"{createdTime:dd.MM.yyyy HH:mm}";
       }
      <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-clock-history" viewBox="0 0 16 16">
             <path d="M8.515 1.019A7 7 0 0 0 8 1V0a8 8 0 0 1 .589.022zm2.004.45a7 7 0 0 0-.985-.299l.219-.976q.576.129 1.126.342zm1.37.71a7 7 0 0 0-.439-.27l.493-.87a8 8 0 0 1 .979.654l-.615.789a7 7 0 0 0-.418-.302zm1.834 1.79a7 7 0 0 0-.653-.796l.724-.69q.406.429.747.91zm.744 1.352a7 7 0 0 0-.214-.468l.893-.45a8 8 0 0 1 .45 1.088l-.95.313a7 7 0 0 0-.179-.483m.53 2.507a7 7 0 0 0-.1-1.025l.985-.17q.1.58.116 1.17zm-.131 1.538q.05-.254.081-.51l.993.123a8 8 0 0 1-.23 1.155l-.964-.267q.069-.247.12-.501m-.952 2.379q.276-.436.486-.908l.914.405q-.24.54-.555 1.038zm-.964 1.205q.183-.183.35-.378l.758.653a8 8 0 0 1-.401.432z"/>
          <path d="M8 1a7 7 0 1 0 4.95 11.95l.707.707A8.001 8.001 0 1 1 8 0z"/>
          <path d="M7.5 3a.5.5 0 0 1 .5.5v5.21l3.248 1.856a.5.5 0 0 1-.496.868l-3.5-2A.5.5 0 0 1 7 9V3.5a.5.5 0 0 1 .5-.5"/>
     </svg>
     @timeAgo
    </div>
     </div>
           </div>
       </div>
     
  <div class="notification-actions">
          <form asp-area="Admin" asp-controller="Appointments" asp-action="SetConfirmation" method="post" style="display:inline">
        @Html.AntiForgeryToken()
 <input type="hidden" name="id" value="@a.Id" />
        <input type="hidden" name="state" value="Gelecek" />
       <input type="hidden" name="returnUrl" value="@Url.Action("Index", "Notifications", new { area = "Admin" })" />
           <button class="btn-notif primary">
      <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-check-circle" viewBox="0 0 16 16">
      <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"/>
      <path d="m10.97 4.97-.02.022-3.473 4.425-2.093-2.094a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-1.071-1.05"/>
          </svg>
         Onayla
       </button>
         </form>
   
  <form asp-area="Admin" asp-controller="Appointments" asp-action="SetConfirmation" method="post" style="display:inline">
      @Html.AntiForgeryToken()
          <input type="hidden" name="id" value="@a.Id" />
 <input type="hidden" name="state" value="Gelmeyecek" />
           <input type="hidden" name="returnUrl" value="@Url.Action("Index", "Notifications", new { area = "Admin" })" />
         <button class="btn-notif secondary">
   <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-x-circle" viewBox="0 0 16 16">
    <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"/>
<path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708"/>
     </svg>
    Reddet
         </button>
      </form>
           
           <a asp-area="Admin" asp-controller="Appointments" asp-action="Index" class="btn-notif secondary">
  <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-calendar-check" viewBox="0 0 16 16">
        <path d="M10.854 7.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 9.793l2.646-2.647a.5.5 0 0 1 .708 0"/>
  <path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5M1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4z"/>
       </svg>
 Tüm Randevular
              </a>
  </div>
     </div>
   }
      </div>
    }
    
    <!-- Okunmamýþ Mesajlar -->
    @if (unreadMessages.Any())
 {
  <div data-reveal class="mt-5">
        <h4 class="mb-4 fw-bold">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-envelope-open d-inline-block" viewBox="0 0 16 16" style="vertical-align:middle;margin-right:8px;">
       <path d="M8.47 1.318a1 1 0 0 0-.94 0l-6 3.2A1 1 0 0 0 1 5.4v.817l5.75 3.45L8 8.917l1.25.75L15 6.217V5.4a1 1 0 0 0-.53-.882zM15 7.383l-4.778 2.867L15 13.117zm-.035 6.88L8 10.082l-6.965 4.18A1 1 0 0 0 2 15h12a1 1 0 0 0 .965-.738ZM1 13.116l4.778-2.867L1 7.383v5.734ZM7.059.435a2 2 0 0 1 1.882 0l6 3.2A2 2 0 0 1 16 5.4V14a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V5.4a2 2 0 0 1 1.059-1.765z"/>
    </svg>
          Okunmamýþ Ýletiþim Mesajlarý (@unreadMessages.Count)
        </h4>
        
 @foreach (var m in unreadMessages)
        {
          <div class="notification-card message">
   <div class="notification-header">
     <div class="d-flex align-items-start flex-grow-1">
    <div class="notification-icon message">
        <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-envelope-paper" viewBox="0 0 16 16">
          <path d="M4 0a2 2 0 0 0-2 2v1.133l-.941.502A2 2 0 0 0 0 5.4V14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V5.4a2 2 0 0 0-1.059-1.765L14 3.133V2a2 2 0 0 0-2-2zm10 4.267.47.25A1 1 0 0 1 15 5.4v.817l-1 .6zm-1 3.15-3.75 2.25L8 8.917l-1.25.75L3 7.417V2a1 1 0 0 1 1-1h8a1 1 0 0 1 1 1zm-11-.6-1-.6V5.4a1 1 0 0 1 .53-.882L2 4.267zm13 .566v5.734l-4.778-2.867zm-.035 6.88A1 1 0 0 1 14 15H2a1 1 0 0 1-.965-.738L8 10.083zM1 13.116V7.383l4.778 2.867L1 13.117Z"/>
              </svg>
              </div>
         <div class="notification-content">
    <div class="notification-title">
          @m.Name
   <span class="badge-new">YENÝ</span>
      </div>
      <div class="notification-details">
     <strong>
          <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-bookmark" viewBox="0 0 16 16">
          <path d="M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v13.5a.5.5 0 0 1-.777.416L8 13.101l-5.223 2.815A.5.5 0 0 1 2 15.5zm2-1a1 1 0 0 0-1 1v12.566l4.723-2.482a.5.5 0 0 1 .554 0L13 14.566V2a1 1 0 0 0-1-1h-8a1 1 0 0 0-1 1z"/>
     </svg>
             @m.Subject
 </strong><br/>
    @{
    var preview = m.Message.Length > 150 
    ? m.Message.Substring(0, 150) + "..."
    : m.Message;
 }
    <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-chat-left-text" viewBox="0 0 16 16">
       <path d="M14 1a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1H4.414A2 2 0 0 0 3 11.586l-2 2V2a1 1 0 0 1 1-1zM2 0a2 2 0 0 0-2 2v12.793a.5.5 0 0 0 .854.353l2.853-2.853A1 1 0 0 1 4.414 12H14a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z"/>
             <path d="M3 3.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5M3 6a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9A.5.5 0 0 1 3 6m0 2.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5"/>
         </svg>
            @preview<br/>
  <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-phone" viewBox="0 0 16 16">
  <path d="M11 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zM5 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z"/>
        <path d="M8 14a1 1 0 1 0 0-2 1 1 0 0 0 0 2"/>
      </svg>
      @m.Phone<br/>
    <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-envelope" viewBox="0 0 16 16">
      <path d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2zm2-1a1 1 0 0 0-1 1v.217l7 4.2 7-4.2V4a1 1 0 0 0-1-1zm13 2.383-4.708 2.825L15 11.105zm-.034 6.876-5.64-3.471L8 9.583l-1.326-.795-5.64 3.47A1 1 0 0 0 2 13h12a1 1 0 0 0 .966-.741M1 11.105l4.708-2.897L1 5.383z"/>
        </svg>
           @m.Email
     </div>
     <div class="notification-time">
        @{
          var msgCreatedTime = m.CreatedAtUtc.ToLocalTime();
       var msgTimeDiff = now - msgCreatedTime;
       var msgTimeAgo = msgTimeDiff.TotalMinutes < 60 
    ? $"{(int)msgTimeDiff.TotalMinutes} dakika önce"
    : msgTimeDiff.TotalHours < 24 
  ? $"{(int)msgTimeDiff.TotalHours} saat önce"
 : $"{msgCreatedTime:dd.MM.yyyy HH:mm}";
          }
     <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-clock-history" viewBox="0 0 16 16">
           <path d="M8.515 1.019A7 7 0 0 0 8 1V0a8 8 0 0 1 .589.022zm2.004.45a7 7 0 0 0-.985-.299l.219-.976q.576.129 1.126.342zm1.37.71a7 7 0 0 0-.439-.27l.493-.87a8 8 0 0 1 .979.654l-.615.789a7 7 0 0 0-.418-.302zm1.834 1.79a7 7 0 0 0-.653-.796l.724-.69q.406.429.747.91zm.744 1.352a7 7 0 0 0-.214-.468l.893-.45a8 8 0 0 1 .45 1.088l-.95.313a7 7 0 0 0-.179-.483m.53 2.507a7 7 0 0 0-.1-1.025l.985-.17q.1.58.116 1.17zm-.131 1.538q.05-.254.081-.51l.993.123a8 8 0 0 1-.23 1.155l-.964-.267q.069-.247.12-.501m-.952 2.379q.276-.436.486-.908l.914.405q-.24.54-.555 1.038zm-.964 1.205q.183-.183.35-.378l.758.653a8 8 0 0 1-.401.432z"/>
          <path d="M8 1a7 7 0 1 0 4.95 11.95l.707.707A8.001 8.001 0 1 1 8 0z"/>
          <path d="M7.5 3a.5.5 0 0 1 .5.5v5.21l3.248 1.856a.5.5 0 0 1-.496.868l-3.5-2A.5.5 0 0 1 7 9V3.5a.5.5 0 0 1 .5-.5"/>
          </svg>
        @msgTimeAgo
         </div>
      </div>
  </div>
</div>
    
<div class="notification-actions">
   <a asp-area="Admin" asp-controller="ContactMessages" asp-action="Details" asp-route-id="@m.Id" class="btn-notif primary">
           <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-eye" viewBox="0 0 16 16">
         <path d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8M1.173 8a13 13 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5s3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5s-3.879-1.168-5.168-2.457A13 13 0 0 1 1.172 8z"/>
             <path d="M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5M4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0"/>
             </svg>
       Görüntüle
 </a>
        
  <a asp-area="Admin" asp-controller="ContactMessages" asp-action="Index" class="btn-notif secondary">
     <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-envelope-check" viewBox="0 0 16 16">
              <path d="M2 2a2 2 0 0 0-2 2v8.01A2 2 0 0 0 2 14h5.5a.5.5 0 0 0 0-1H2a1 1 0 0 1-.966-.741l5.64-3.471L8 9.583l7-4.2V8.5a.5.5 0 0 0 1 0V4a2 2 0 0 0-2-2zm3.708 6.208L1 11.105V5.383zM1 4.217V4a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v.217l-7 4.2z"/>
            <path d="M16 12.5a3.5 3.5 0 1 1-7 0 3.5 3.5 0 0 1 7 0m-1.993-1.679a.5.5 0 0 0-.686.172l-1.17 1.95-.547-.547a.5.5 0 0 0-.708.708l.774.773a.75.75 0 0 0 1.174-.144l1.335-2.226a.5.5 0 0 0-.172-.686"/>
       </svg>
      Tüm Mesajlar
   </a>
</div>
     </div>
   }
    </div>
    }
  }
</div>

@section Scripts{
<script>
  // Reveal animation
  const reveals=[...document.querySelectorAll('[data-reveal]')];
  if('IntersectionObserver' in window){
    const io=new IntersectionObserver((entries)=>{
      entries.forEach(en=>{ 
        if(en.isIntersecting){ 
   setTimeout(()=>en.target.classList.add('in'), 100); 
          io.unobserve(en.target); 
     } 
      });
    },{threshold:.1, rootMargin:'0px 0px -50px 0px'});
    reveals.forEach(e=>io.observe(e));
  } else {
    reveals.forEach(e=>e.classList.add('in'));
  }
</script>
}
