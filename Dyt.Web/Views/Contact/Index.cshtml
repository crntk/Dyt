@model Dyt.Web.Controllers.ContactController.ContactForm
@{
    ViewData["Title"] = "Ýletiþim";
}

<style>
  :root{ --pink:#e91e63; --bg:#fffafc; }
  .contact-hero{background:radial-gradient(1000px 400px at 10% -20%, rgba(233,30,99,.18), transparent),radial-gradient(900px 360px at 90% -10%, rgba(255,255,255,.30), transparent);}
  .chip{display:inline-flex;align-items:center;gap:8px;padding:7px 12px;border-radius:999px;border:1px solid rgba(233,30,99,.35);background:rgba(233,30,99,.08);cursor:pointer;font-weight:600;color:#e91e63}
  .chip.active{background:#e91e63;border-color:#e91e63;color:#fff}
  .card{border-radius:16px}
  .list-tick{list-style:none;padding-left:0;margin:0}
  .list-tick li{display:flex;align-items:center;gap:8px;margin-bottom:8px}
  .list-tick li::before{content:"?";color:#22c55e}
  .kpi{display:flex;gap:12px;align-items:center}
  .kpi .icon{width:42px;height:42px;border-radius:10px;display:inline-flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#e91e63,#ff9fbd);color:#fff;box-shadow:0 8px 20px rgba(233,30,99,.25)}
  .hover-lift{transition:transform .15s ease, box-shadow .15s ease}
  .hover-lift:hover{transform:translateY(-3px); box-shadow:0 18px 40px rgba(0,0,0,.10)!important}
  .contact-link{display:flex;align-items:center;gap:10px;padding:10px;border:1px solid #eee;border-radius:12px;background:#fff}
  .contact-link .copy{margin-left:auto}
  .progress-wrap{height:8px;background:#f1f5f9;border-radius:10px;overflow:hidden}
  .progress-bar{height:8px;background:linear-gradient(90deg,#e91e63,#ff9fbd);width:0}
  .toastx{position:fixed;right:16px;bottom:16px;z-index:1080;display:none;}

  /* reveal */
  [data-animate]{opacity:0;transform:translateY(6px);transition:opacity .4s ease, transform .4s ease}
  [data-animate].in{opacity:1;transform:none}
</style>

<!-- Hero -->
<section class="contact-hero py-5">
  <div class="container">
    <div class="row align-items-center g-4">
      <div class="col-lg-7" data-animate>
        <h1 class="display-6 fw-bold mb-2">Bize Ulaþýn</h1>
        <p class="lead mb-0">Sorunuz, randevu talebiniz veya geri bildiriminiz için formu doldurun. En kýsa sürede dönüþ yapalým.</p>
      </div>
      <div class="col-lg-5" data-animate>
        <div class="kpi">
          <div class="icon">??</div>
          <div>
            <div class="h4 mb-0">Hýzlý dönüþ</div>
            <div class="text-muted small">Mesajlara ayný gün içinde yanýt</div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<div class="container py-4">
  <div class="row g-4">
    <!-- Form -->
    <div class="col-lg-7" data-animate>
      @if (TempData["Msg"] is string m){
        <div class="alert alert-success hover-lift">@m</div>
      }
      <div class="card shadow-sm hover-lift">
        <div class="card-body">
          <div class="d-flex align-items-center justify-content-between mb-2">
            <h5 class="card-title mb-0">Ýletiþim Formu</h5>
            <div class="progress-wrap" style="width:180px"><div id="progress" class="progress-bar"></div></div>
          </div>

          <div class="mb-2 small text-muted">Konu baþlýðý seçmek için etiketlere týklayýn:</div>
          <div class="d-flex flex-wrap gap-2 mb-3">
            <button type="button" class="chip js-chip" data-text="Randevu Hakkýnda">#Randevu</button>
            <button type="button" class="chip js-chip" data-text="Beslenme Programý">#Program</button>
            <button type="button" class="chip js-chip" data-text="Kurumsal Ýþ Birliði">#Kurumsal</button>
            <button type="button" class="chip js-chip" data-text="Diðer">#Diðer</button>
          </div>

          <form method="post" id="cform" novalidate>
            @Html.AntiForgeryToken()
            <div asp-validation-summary="ModelOnly" class="text-danger"></div>
            <div class="row g-3">
              <div class="col-md-6">
                <label class="form-label">Ad Soyad</label>
                <input asp-for="Name" class="form-control" placeholder="Adýnýz Soyadýnýz" />
                <span asp-validation-for="Name" class="text-danger"></span>
              </div>
              <div class="col-md-6">
                <label class="form-label">E-posta</label>
                <input asp-for="Email" class="form-control" placeholder="mail@ornek.com" />
                <span asp-validation-for="Email" class="text-danger"></span>
              </div>
              <div class="col-12">
                <label class="form-label">Konu</label>
                <input asp-for="Subject" class="form-control" placeholder="Kýsaca konuyu yazýn" />
                <span asp-validation-for="Subject" class="text-danger"></span>
              </div>
              <div class="col-12">
                <label class="form-label">Mesaj</label>
                <textarea asp-for="Message" rows="6" class="form-control" placeholder="Mesajýnýzý yazýn"></textarea>
                <div class="d-flex justify-content-between small mt-1">
                  <span asp-validation-for="Message" class="text-danger"></span>
                  <span id="charCount" class="text-muted">0 karakter</span>
                </div>
              </div>
            </div>

            <div class="form-check mt-3 mb-2">
              <input class="form-check-input" type="checkbox" id="consent">
              <label class="form-check-label" for="consent">KVKK aydýnlatma metnini okudum, bilgilendirildim.</label>
            </div>

            <div class="d-flex gap-2 justify-content-end mt-2">
              <button id="btnReset" type="button" class="btn btn-outline-secondary">Temizle</button>
              <button id="btnSend" class="btn btn-primary">
                <span class="send-text">Gönder</span>
                <span class="spinner-border spinner-border-sm ms-2 d-none" role="status" aria-hidden="true"></span>
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Info -->
    <div class="col-lg-5" data-animate>
      <div class="card shadow-sm mb-3 hover-lift">
        <div class="card-body">
          <h5 class="card-title">Ýletiþim Kanallarý</h5>
          <div class="d-flex flex-column gap-2">
            <div class="contact-link">
              <span>??</span>
              <a href="tel:+905551112233" class="text-reset text-decoration-none">+90 555 111 22 33</a>
              <button class="btn btn-sm btn-light copy" data-copy="+905551112233">Kopyala</button>
            </div>
            <div class="contact-link">
              <span>??</span>
              <a href="mailto:info@ornek.com" class="text-reset text-decoration-none">info@ornek.com</a>
              <button class="btn btn-sm btn-light copy" data-copy="info@ornek.com">Kopyala</button>
            </div>
            <div class="contact-link">
              <span>??</span>
              <span>Merkez Mh. Saðlýk Sk. No:10, Ýstanbul</span>
              <a class="btn btn-sm btn-outline-secondary ms-auto" target="_blank" href="https://maps.google.com/?q=Merkez%20Mahallesi%20Sa%C4%9Fl%C4%B1k%20Sk%2010%20Istanbul">Haritada Aç</a>
            </div>
          </div>
        </div>
      </div>

      <div class="card shadow-sm mb-3 hover-lift">
        <div class="card-body">
          <h5 class="card-title">Çalýþma Saatleri</h5>
          <ul class="list-tick text-muted small">
            <li>Pazartesi - Cuma: 10:00 - 19:00</li>
            <li>Cumartesi: 10:00 - 16:00</li>
            <li>Pazar: Kapalý</li>
          </ul>
        </div>
      </div>

      <div class="card shadow-sm hover-lift">
        <div class="card-body">
          <h5 class="card-title">Sosyal Medya</h5>
          <div class="d-flex gap-2 flex-wrap">
            <a class="btn btn-sm btn-outline-secondary" target="_blank" href="#">?? Instagram</a>
            <a class="btn btn-sm btn-outline-secondary" target="_blank" href="#">?? X</a>
            <a class="btn btn-sm btn-outline-secondary" target="_blank" href="#">?? YouTube</a>
            <a class="btn btn-sm btn-outline-secondary" target="_blank" href="#">?? LinkedIn</a>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="toastx">
  <div class="alert alert-success shadow-sm mb-0">Panoya kopyalandý ?</div>
</div>

@section Scripts{
  <partial name="_ValidationScriptsPartial" />
  <script>
    (function(){
      // reveal on scroll
      const reveal=()=>document.querySelectorAll('[data-animate]').forEach(el=>{ const r=el.getBoundingClientRect(); if(r.top < window.innerHeight-60) el.classList.add('in'); });
      reveal(); window.addEventListener('scroll', reveal);

      // chips -> subject
      const chips = document.querySelectorAll('.js-chip');
      const subject = document.getElementById('Subject');
      chips.forEach(c=> c.addEventListener('click', function(){ chips.forEach(x=>x.classList.remove('active')); this.classList.add('active'); if(subject && !subject.value){ subject.value=this.dataset.text||''; subject.dispatchEvent(new Event('input')); }}));

      // progress + char count + send animation
      const form = document.getElementById('cform');
      const name = document.getElementById('Name');
      const email = document.getElementById('Email');
      const message = document.getElementById('Message');
      const progress = document.getElementById('progress');
      const charCount = document.getElementById('charCount');
      const btnSend = document.getElementById('btnSend');
      const spinner = btnSend.querySelector('.spinner-border');
      const sendText = btnSend.querySelector('.send-text');
      const btnReset = document.getElementById('btnReset');

      function upd(){
        const len = (message?.value||'').length; charCount.textContent = len + ' karakter';
        let p = 10; if(name?.value) p+=25; if(email?.value) p+=20; if(subject?.value) p+=20; if(len>5) p+=25; progress.style.width = Math.min(100,p)+'%';
      }
      ['input','change'].forEach(ev=>{ [name,email,subject,message].forEach(x=>x&&x.addEventListener(ev,upd)); });
      upd();

      form?.addEventListener('submit', function(){ btnSend.disabled=true; spinner.classList.remove('d-none'); sendText.textContent='Gönderiliyor'; });
      btnReset?.addEventListener('click', function(){ form.reset(); document.querySelectorAll('.js-chip').forEach(x=>x.classList.remove('active')); upd(); });

      // copy helpers
      const toast = document.querySelector('.toastx'); let tHandle;
      document.querySelectorAll('.copy').forEach(b=> b.addEventListener('click', async function(){ try{ await navigator.clipboard.writeText(this.dataset.copy||''); toast.style.display='block'; clearTimeout(tHandle); tHandle=setTimeout(()=> toast.style.display='none', 1200); }catch{} }));
    })();
  </script>
}
