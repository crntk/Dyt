import{r as g,j as n,a as k,c as N,b as P}from"./chunks/random.js";function B(a){const[r,e]=g.useState(null);return g.useEffect(()=>{if(!a||a.length===0){e([]);return}let m=!1;return Promise.all(a.map(p=>new Promise(l=>{const i=new Image;i.onload=()=>l({src:p,img:i,w:i.naturalWidth||64,h:i.naturalHeight||64,ratio:(i.naturalWidth||64)/(i.naturalHeight||64)}),i.onerror=()=>l({src:p,img:i,w:64,h:64,ratio:1}),i.src=p}))).then(p=>{m||e(p)}),()=>{m=!0}},[a]),r}const G=({sprites:a,fruitCount:r=61,onAnimationComplete:e})=>{const m=g.useRef(null),p=g.useRef(null),l=B(a||[]),[i,C]=g.useState(!0),F=g.useRef({fruits:[],animationStartTime:0,initialized:!1});return g.useEffect(()=>{const c=m.current;if(!c||!l||l.length===0)return;const x=F.current;let S=0,M=0;const R=()=>{const w=window.innerWidth,h=window.innerHeight,d=w/2,u=h*.45,s=140,o=N(Date.now()),y=[];for(let f=0;f<r;f++){const v=Math.PI*2*f/r,j=k(o,10,s-40),b=k(o,40,70);y.push({x:d+Math.cos(v)*j,y:u+Math.sin(v)*j*.4,vx:(Math.random()-.5)*400+Math.cos(v)*200,vy:-Math.random()*600-400,rotation:Math.random()*Math.PI*2,rotationSpeed:(Math.random()-.5)*10,size:b,spriteIndex:f%a.length,delay:f*25,hasStarted:!1})}x.fruits=y,x.animationStartTime=performance.now(),x.initialized=!0},I=w=>{S=requestAnimationFrame(I);const h=Math.min(.02,(w-M)/1e3);if(M=w,h<=0)return;const d=window.innerWidth,u=window.innerHeight;x.initialized||R();const s=c.getContext("2d");if(!s)return;const o=window.devicePixelRatio||1;(c.width!==d*o||c.height!==u*o)&&(c.width=d*o,c.height=u*o,c.style.width=d+"px",c.style.height=u+"px",s.setTransform(o,0,0,o,0,0));const y=w-x.animationStartTime,{fruits:f}=x,v=900,j=u+100;let b=!0;for(const t of f){if(y<t.delay){b=!1;continue}t.hasStarted||(t.hasStarted=!0),t.vy+=v*h,t.x+=t.vx*h,t.y+=t.vy*h,t.rotation+=t.rotationSpeed*h,t.vx*=.995,t.vy*=.998,t.y<j&&(b=!1),(t.x<0||t.x>d)&&(t.vx=-t.vx*.7,t.x=Math.max(0,Math.min(d,t.x)))}s.clearRect(0,0,d,u);for(const t of f){if(!t.hasStarted)continue;s.save(),s.translate(t.x,t.y),s.rotate(t.rotation),s.globalAlpha=.85;const A=l[t.spriteIndex%l.length],z=t.size,E=t.size/A.ratio;s.drawImage(A.img,-z/2,-E/2,z,E),s.restore()}b&&y>3500&&(C(!1),e&&e(),cancelAnimationFrame(S))};return R(),S=requestAnimationFrame(I),()=>{cancelAnimationFrame(S)}},[l,r,a.length,e]),i?n.jsxs("div",{className:"bowl-spill-container",style:{background:"transparent"},children:[n.jsx("div",{ref:p,className:"bowl",children:n.jsxs("svg",{viewBox:"0 0 200 120",xmlns:"http://www.w3.org/2000/svg",children:[n.jsx("ellipse",{cx:"100",cy:"110",rx:"85",ry:"15",fill:"rgba(0,0,0,0.1)"}),n.jsx("defs",{children:n.jsxs("linearGradient",{id:"bowlGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[n.jsx("stop",{offset:"0%",style:{stopColor:"#f9a825",stopOpacity:1}}),n.jsx("stop",{offset:"100%",style:{stopColor:"#ff6f00",stopOpacity:1}})]})}),n.jsx("ellipse",{cx:"100",cy:"40",rx:"90",ry:"20",fill:"url(#bowlGradient)"}),n.jsx("path",{d:"M 10 40 Q 10 90, 100 100 Q 190 90, 190 40 Z",fill:"url(#bowlGradient)",opacity:"0.9"}),n.jsx("ellipse",{cx:"100",cy:"40",rx:"85",ry:"18",fill:"#fdd835"}),n.jsx("ellipse",{cx:"80",cy:"35",rx:"30",ry:"8",fill:"rgba(255,255,255,0.4)"})]})}),n.jsx("canvas",{ref:m,className:"bowl-spill-canvas"})]}):null};function T(){if(window.location.pathname!=="/"||sessionStorage.getItem("bowlAnimationShown"))return;const r="bowl-spill-root";let e=document.getElementById(r);e||(e=document.createElement("div"),e.id=r,document.body.appendChild(e));const m=()=>{sessionStorage.setItem("bowlAnimationShown","true"),setTimeout(()=>{e&&e.parentNode&&e.parentNode.removeChild(e)},500)};P(e).render(n.jsx(G,{sprites:["/img/sprites/biber.png","/img/sprites/brokoli.png","/img/sprites/cilek.png","/img/sprites/dolmabiber.png","/img/sprites/domates.png","/img/sprites/kiraz.png","/img/sprites/kivi.png","/img/sprites/muz.png","/img/sprites/portakal.png"],fruitCount:100,onAnimationComplete:m}))}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",T):T();
